import{j as e,r as g,u as ie,f as de,d as ce,g as me,e as xe}from"./main-BNgP4cYw.js";import{a as O,e as ue,f as pe,h as he,i as fe,j as ge,k as be,g as je}from"./applicants-0HURkNEA.js";import{c as ye,a as ve,B as R,u as P}from"./button-CvDLn6Uk.js";import{b as Ne,C as V,a as _e}from"./card-ByGSDkCy.js";import{I as w}from"./input-xlrhOAfo.js";import{c as K,b as F}from"./createLucideIcon-CyiQfnON.js";import{S as Ce,a as we,b as Fe,c as Se,d as q,P as Ae}from"./select-BkXzRPpI.js";import{R as Re,C as ke,f as H,e as Ie,P as Ee,O as Pe,T as De,a as Le,b as Me,c as Ue}from"./index-Bh2CNqln.js";import{L as ze}from"./loader-circle-B6V1HC-7.js";import"./check-B-GwoISf.js";import"./index-BBC3RJW9.js";const Be=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Te=K("trash",Be);const Oe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ve=K("x",Oe);function qe({className:a}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,viewBox:"0 0 32 33",fill:"none",children:e.jsx("path",{d:"M25.9043 17.6242C25.9043 17.4302 25.824 17.2441 25.6812 17.107C25.5383 16.9698 25.3445 16.8927 25.1424 16.8927H10.22L15.7771 11.5591C15.8478 11.4912 15.904 11.4105 15.9422 11.3217C15.9806 11.2329 16.0003 11.1378 16.0003 11.0417C16.0003 10.9456 15.9806 10.8504 15.9422 10.7616C15.904 10.6728 15.8478 10.5922 15.7771 10.5242C15.7062 10.4563 15.6222 10.4024 15.5297 10.3656C15.4372 10.3288 15.338 10.3099 15.2379 10.3099C15.1378 10.3099 15.0388 10.3288 14.9463 10.3656C14.8538 10.4024 14.7697 10.4563 14.699 10.5242L7.84197 17.1067C7.77127 17.1746 7.71504 17.2552 7.67664 17.3441C7.63839 17.4329 7.61858 17.528 7.61858 17.6242C7.61858 17.7203 7.63839 17.8154 7.67664 17.9042C7.71504 17.9931 7.77127 18.0737 7.84197 18.1416L14.699 24.724C14.8419 24.8613 15.0359 24.9384 15.2379 24.9384C15.4401 24.9384 15.6341 24.8613 15.7771 24.724C15.92 24.5869 16.0003 24.4007 16.0003 24.2067C16.0003 24.0126 15.92 23.8264 15.7771 23.6892L10.22 18.3556H25.1424C25.3445 18.3556 25.5383 18.2785 25.6812 18.1413C25.824 18.0042 25.9043 17.8181 25.9043 17.6242Z",fill:"black"})})}var Ke=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],He=Ke.reduce((a,r)=>{const s=ye(`Primitive.${r}`),p=g.forwardRef((h,o)=>{const{asChild:x,...f}=h,y=x?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(y,{...f,ref:o})});return p.displayName=`Primitive.${r}`,{...a,[r]:p}},{}),Qe="Label",Q=g.forwardRef((a,r)=>e.jsx(He.label,{...a,ref:r,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(a.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));Q.displayName=Qe;var $=Q;const $e=ve("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),N=g.forwardRef(({className:a,...r},s)=>e.jsx($,{ref:s,className:F($e(),a),...r}));N.displayName=$.displayName;function Ze({...a}){return e.jsx(Re,{"data-slot":"dialog",...a})}function We({...a}){return e.jsx(Ee,{"data-slot":"dialog-portal",...a})}function Xe({...a}){return e.jsx(H,{"data-slot":"dialog-close",...a})}function Ge({className:a,...r}){return e.jsx(Pe,{"data-slot":"dialog-overlay",className:F("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...r})}function Je({className:a,children:r,showCloseButton:s=!0,...p}){return e.jsxs(We,{"data-slot":"dialog-portal",children:[e.jsx(Ge,{}),e.jsxs(ke,{"data-slot":"dialog-content",className:F("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...p,children:[r,s&&e.jsxs(H,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Ve,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Ye({className:a,...r}){return e.jsx("div",{"data-slot":"dialog-header",className:F("flex flex-col gap-2 text-center sm:text-left",a),...r})}function et({className:a,...r}){return e.jsx("div",{"data-slot":"dialog-footer",className:F("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...r})}function tt({className:a,...r}){return e.jsx(Ie,{"data-slot":"dialog-title",className:F("text-lg leading-none font-semibold",a),...r})}const at=({open:a,onOpenChange:r,onSave:s,loading:p,message:h})=>{const[o,x]=g.useState(""),f=b=>b.replace(/\b\w/g,i=>i.toUpperCase()),y=()=>{o.trim()&&(s(o),x(""))},j=b=>{r(b),b||x("")};return e.jsx(Ze,{open:a,onOpenChange:j,children:e.jsxs(Je,{className:"sm:max-w-md",children:[e.jsx(Ye,{children:e.jsx(tt,{children:"Add New Position"})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(w,{placeholder:"Enter new position",value:o,onChange:b=>{b.nativeEvent.inputType==="deleteContentBackward"?x(b.target.value.trimStart()):x(f(b.target.value.trimStart()))},disabled:p}),h&&e.jsx("p",{className:"text-sm text-red-500",children:h})]}),e.jsxs(et,{className:"flex justify-end gap-2 mt-4",children:[e.jsx(Xe,{asChild:!0,children:e.jsx(R,{variant:"outline",disabled:p,className:"cursor-pointer",children:"Cancel"})}),e.jsx(R,{onClick:y,disabled:!o.trim()||p,className:"bg-[#05A155] hover:bg-[#05A155] text-white cursor-pointer",children:p?"Saving...":"Save"})]})]})})};function st({className:a}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,viewBox:"0 0 18 17",fill:"none",children:e.jsx("path",{d:"M17.401 10.6578V16.2576C17.401 16.4433 17.3273 16.6213 17.196 16.7526C17.0647 16.8838 16.8867 16.9576 16.701 16.9576H1.30154C1.11589 16.9576 0.937852 16.8838 0.806581 16.7526C0.67531 16.6213 0.601562 16.4433 0.601562 16.2576V10.6578C0.601562 10.4722 0.67531 10.2941 0.806581 10.1628C0.937852 10.0316 1.11589 9.95782 1.30154 9.95782C1.48719 9.95782 1.66523 10.0316 1.7965 10.1628C1.92777 10.2941 2.00152 10.4722 2.00152 10.6578V15.5576H16.0011V10.6578C16.0011 10.4722 16.0748 10.2941 16.2061 10.1628C16.3373 10.0316 16.5154 9.95782 16.701 9.95782C16.8867 9.95782 17.0647 10.0316 17.196 10.1628C17.3273 10.2941 17.401 10.4722 17.401 10.6578ZM5.5014 5.05798H8.30131V10.6578C8.30131 10.8434 8.37506 11.0215 8.50633 11.1528C8.6376 11.284 8.81564 11.3578 9.00129 11.3578C9.18693 11.3578 9.36498 11.284 9.49625 11.1528C9.62752 11.0215 9.70126 10.8434 9.70126 10.6578V5.05798H12.5012C12.6397 5.05809 12.7751 5.0171 12.8903 4.94019C13.0056 4.86328 13.0954 4.75392 13.1484 4.62595C13.2014 4.49798 13.2153 4.35715 13.1882 4.2213C13.1612 4.08544 13.0944 3.96067 12.9964 3.86277L9.49652 0.362887C9.43151 0.297805 9.35431 0.246176 9.26934 0.21095C9.18436 0.175724 9.09328 0.157593 9.00129 0.157593C8.9093 0.157593 8.81821 0.175724 8.73324 0.21095C8.64826 0.246176 8.57106 0.297805 8.50605 0.362887L5.00617 3.86277C4.90816 3.96067 4.84141 4.08544 4.81435 4.2213C4.7873 4.35715 4.80116 4.49798 4.85419 4.62595C4.90721 4.75392 4.99702 4.86328 5.11223 4.94019C5.22744 5.0171 5.36288 5.05809 5.5014 5.05798Z",fill:"#333333"})})}function lt({formData:a,uploadedFile:r,errors:s,message:p,isSubmitting:h,setErrors:o,onChange:x,onSave:f,handleBackNavigate:y,handleFileUpload:j,handleDeleteFile:b,loading:i=!1,roleList:k=[],isAdding:C,isEdit:I=!1,addRoleMessage:D,setAddRoleMessage:v=()=>{},onAddRole:L,dialogOpen:S,setDialogOpen:E}){const _=r?.name??"",M=_?.length>20,c=(l,m)=>{x({[l]:m})},B=()=>{const l=localStorage.getItem("recentRoleId");return l?k.find(m=>m.id===Number(l)):null};return e.jsxs("div",{className:"w-full max-w-3xl 3xl:!max-w-4xl h-full mx-auto",children:[e.jsxs(Ne,{className:"text-gray-700 flex items-center mb-2",children:[e.jsx("button",{className:"mr-3 text-sm 2xl:text-base 3xl:!text-base cursor-pointer",onClick:y,children:e.jsx(qe,{className:"!w-7 !h-7"})}),e.jsx("div",{className:"text-[#000] font-normal",children:I?"Edit Applicant":"Add Applicant"})]}),e.jsxs(V,{className:"w-full bg-white shadow-none rounded-base p-0 pt-3 border border-[#D9D9D9]",children:[e.jsx(_e,{className:"!px-4",children:e.jsxs("div",{className:"!px-0 flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"position",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"Position"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ce,{value:a.role_id?String(a.role_id):"",onValueChange:l=>{const m=Number(l);x({role_id:m})},children:[e.jsx(we,{className:"w-[49%] !h-9 shadow-none bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",children:e.jsx(Fe,{placeholder:"Please select position"})}),e.jsxs(Se,{className:"max-h-[250px] overflow-y-auto",children:[(()=>{const l=B();return l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-gray-500 font-medium capitalize tracking-wide",children:"Recently Used"}),e.jsx(q,{value:String(l.id),className:"font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 border-l-2 border-blue-500",children:l.name},`recent-${l.id}`),e.jsx("hr",{className:"my-2 border-t border-gray-200"}),e.jsx("div",{className:"px-2 py-1 text-xs text-gray-500 font-medium capitalize tracking-wide",children:"All Positions"})]}):null})(),(()=>{const l=localStorage.getItem("recentRoleId");return k.filter(m=>m.id!==Number(l)).map(m=>e.jsx(q,{value:String(m.id),children:m.name},m.id))})()]})]}),e.jsx(R,{className:"bg-[#F6F6F6] hover:bg-[#F6F6F6] text-black cursor-pointer",onClick:()=>{E(!0),v(""),x({}),s.role_id&&o(l=>({...l,role_id:[]}))},children:e.jsx(Ae,{})})]}),s.role_id&&e.jsx("p",{className:"text-red-500 text-xs",children:s.role_id})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-[#A05148] font-medium text-base 3xl:!text-lg",children:"Personal & Contact Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-0.75",children:[e.jsx(N,{htmlFor:"firstName",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"First Name"}),e.jsx(w,{id:"firstName",placeholder:"First name of applicant",value:a.first_name,onChange:l=>c("first_name",l.target.value.trimStart()),className:"!h-9 shadow-none bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",disabled:i}),s.first_name&&e.jsx("p",{className:"text-red-500 text-xs",children:s.first_name})]}),e.jsxs("div",{className:"space-y-0.75",children:[e.jsx(N,{htmlFor:"lastName",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"Last Name"}),e.jsx(w,{id:"lastName",placeholder:"Last name of applicant",value:a.last_name,onChange:l=>c("last_name",l.target.value.trimStart()),className:"!h-9 shadow-none bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",disabled:i}),s.last_name&&e.jsx("p",{className:"text-red-500 text-xs",children:s.last_name})]}),e.jsxs("div",{className:"space-y-0.75",children:[e.jsx(N,{htmlFor:"email",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"Email ID"}),e.jsx(w,{id:"email",placeholder:"Enter email",type:"email",value:a.email,onChange:l=>c("email",l.target.value.trimStart()),className:"!h-9 shadow-none bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",disabled:i}),s.email&&e.jsx("p",{className:"text-red-500 text-xs",children:s.email})]}),e.jsxs("div",{className:"space-y-0.75",children:[e.jsx(N,{htmlFor:"mobile",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"Mobile Number"}),e.jsxs("div",{className:"flex items-center gap-2 bg-neutral-100 rounded-md border border-neutral-100",children:[e.jsx("p",{className:"border-r border-neutral-300 px-2 text-sm",children:"+91"}),e.jsx(w,{id:"mobile",placeholder:"Enter mobile number",value:a.phone.replace(/^\+91/,""),onChange:l=>{const U=l.target.value.trimStart().replace(/\D/g,"");c("phone",U)},maxLength:10,className:"!h-9 shadow-none text-sm border-none px-2 placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",disabled:i})]}),s.phone&&e.jsx("p",{className:"text-red-500 text-xs",children:s.phone})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(N,{htmlFor:"experience",className:"text-[15px] 3xl:!text-base text-[#333] font-medium",children:"Experience"}),e.jsx(w,{type:"number",id:"experience",placeholder:"Enter applicant experience",value:a.experience?.toString(),onKeyDown:l=>{["-","+","e","E"].includes(l.key)&&l.preventDefault()},onChange:l=>c("experience",l.target.value===""?null:Number(l.target.value.trimStart())),min:0,className:"w-[49%] !h-9 shadow-none bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",disabled:i}),s.experience&&e.jsx("p",{className:"text-red-500 text-xs",children:s.experience})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[#A05148] font-medium text-base 3xl:!text-lg",children:"Attachments"}),e.jsxs("div",{className:"space-y-0.75",children:[e.jsx(N,{htmlFor:"upload",className:"text-[15px] 3xl:!text-base text-[#333] font-medium after:content-['_*'] after:text-red-500",children:"Upload Document"}),r?e.jsx(V,{className:"bg-white border border-gray-200 rounded p-3 w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx(De,{children:M?e.jsxs(Le,{children:[e.jsx(Me,{asChild:!0,children:e.jsxs("p",{className:"text-sm font-medium text-gray-900 cursor-help",children:[_.slice(0,40),"..."]})}),e.jsx(Ue,{children:e.jsx("p",{children:_})})]}):e.jsx("p",{className:"text-sm font-medium text-gray-900",children:_})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.type," - ",r.size]})]})}),i?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ze,{className:"text-black animate-spin"})}):e.jsx("button",{onClick:b,className:"p-2 bg-red-100 rounded border border-red-200 transition-colors hover:bg-red-200 cursor-pointer",disabled:i,children:e.jsx(Te,{className:"w-4 h-4"})})]})}):e.jsxs("div",{className:"relative flex items-center justify-center h-20 bg-[#F6F6F6] border border-[#F2F2F2] rounded-[5px] text-sm placeholder:text-[#A3A3AB] text-[#333] font-normal focus:ring-0 focus-visible:ring-0",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:j,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"file-upload",disabled:i}),e.jsxs("span",{className:"mr-3 text-sm 3xl:!text-base text-[#828282] font-normal flex items-center justify-center gap-2",children:[e.jsx(st,{className:"!w-3.5 !h-3.5"}),e.jsx("span",{className:"text-sm 3xl:!text-base text-[#828282] font-medium",children:"Drop files to attach or"}),e.jsx("span",{className:"text-[#4F4F4F] font-normal ml-2 cursor-pointer text-sm 3xl:!text-base border border-[#E0E0E0] px-2 rounded py-0.5",children:"Browse"})]})]}),s.resume_key_path&&e.jsx("p",{className:"text-red-500 text-xs",children:s.resume_key_path})]})]})]})}),p&&e.jsx("p",{className:"text-red-500 text-xs pl-5 p-1",children:p})]}),e.jsx(at,{open:S,onOpenChange:l=>{E(l),l||v("")},onSave:l=>L(l),loading:C,message:D}),e.jsxs("div",{className:"flex justify-end gap-2 w-full p-3 pr-0",children:[e.jsx(R,{variant:"outline",className:"text-base 3xl:!text-base px-3 h-8 text-[#4F4F4F] rounded-sm font-normal border border-[rgba(0,0,0,0.21)] shadow-none cursor-pointer",onClick:y,disabled:i,children:"Cancel"}),e.jsx(R,{className:"text-base 3xl:!text-base bg-[#05A155] px-6 h-8 text-white rounded-sm hover:bg-[#05A155] shadow-none font-light cursor-pointer",onClick:f,disabled:h,children:h?I?"Updating...":"Saving...":I?"Update":"Save"})]})]})}const nt=()=>{const a=ie(),r=de(),s=ce({strict:!1}),p=me(),h="id"in s&&!!s.id,o=r.location.state?.candidate,[x,f]=g.useState({role_id:null,first_name:"",last_name:"",email:"",phone:"+91",experience:null,resume_key_path:""}),[y,j]=g.useState(null),[b,i]=g.useState({}),[k,C]=g.useState(""),[I,D]=g.useState(null),v=xe(),[L,S]=g.useState(null),[E,_]=g.useState(!1),M=()=>{const t=localStorage.getItem("recentRoleId"),n=localStorage.getItem("recentRoleSelectedAt");return n&&(Date.now()-Number(n))/864e5>30?(localStorage.removeItem("recentRoleId"),localStorage.removeItem("recentRoleSelectedAt"),null):t?Number(t):null},{data:c,isLoading:B,refetch:l}=O({queryKey:["user",s.id],queryFn:()=>be(s.id),enabled:h&&!!s?.id});g.useEffect(()=>{if(c&&h&&(f({role_id:c?.data?.role_id??0,first_name:c?.data?.first_name??"",last_name:c?.data?.last_name??"",email:c?.data?.email??"",phone:c?.data?.phone??"",experience:c?.data?.experience??null,resume_key_path:c?.data?.resume_key_path??""}),c?.data?.resume_key_path)){const t=c.data.resume_key_path.split("/").pop().replace(/_.*/g,"");j({name:t??"Uploaded Resume",size:c.resume_file_size??"",type:c.resume_file_type??"PDF"})}},[c,h]),g.useEffect(()=>{o&&!c&&(f({role_id:o.role_id??void 0,first_name:o.first_name??"",last_name:o.last_name??"",email:o.email??"",phone:o.phone??"",experience:o.experience??null,resume_key_path:o.resume_key_path??""}),o.resume_key_path&&j({name:o.resume_file_name??"Uploaded Resume",size:o.resume_file_size??"",type:o.resume_file_type??"PDF"}))},[o,c]);const{data:m}=O({queryKey:["roles"],queryFn:async()=>await je()}),U=m?.data?.map(t=>({id:t.id,name:t.role}));g.useEffect(()=>{if(!h&&!o&&m?.data){const t=M();t&&(m.data.some(d=>d.id===t)||(localStorage.removeItem("recentRoleId"),localStorage.removeItem("recentRoleSelectedAt")))}},[m,h,o]);const T=P({mutationFn:ue,onSuccess:async(t,n)=>{try{const d=t?.data?.data?.target_url;if(!d)throw new Error("No presigned URL found");await pe({url:d,file:n});const u=t?.data?.data?.file_key;f(z=>({...z,resume_key_path:u})),C("")}catch(d){i(u=>({...u,resume_key_path:[d.message||"Failed to upload to S3"]})),j(null),f(u=>({...u,resume_key_path:""})),C(d.message||"Failed to upload to S3")}},onError:t=>{const n=t?.data.errors?.file_type||t?.data.message||"File upload failed. Please try again.";i(d=>({...d,resume_key_path:[n]})),j(null),f(d=>({...d,resume_key_path:""}))}}),{mutateAsync:Z,isPending:W}=P({mutationFn:t=>he(t),onSuccess:async()=>{await v.refetchQueries({queryKey:["applicants"]}),await v.refetchQueries({queryKey:["stats"]}),a({to:"/applicants"})},onError:t=>{t.data.status===422&&t.data.errors?i(t.data.errors):C(t.data.message)}}),{mutateAsync:X,isPending:G}=P({mutationFn:t=>fe(s.id,t),onSuccess:async()=>{await v.refetchQueries({queryKey:["applicants"]}),await v.refetchQueries({queryKey:["stats"]}),a({to:"/applicants"}),l()},onError:t=>{t.data.status===422&&t.data.errors?i(t.data.errors):C(t?.data.message)}}),{mutateAsync:J,isPending:Y}=P({mutationFn:t=>ge(t),onSuccess:async()=>{await v.refetchQueries({queryKey:["roles"]}),S(null),_(!1)},onError:t=>{S(t.data.message||"Failed to add role. Please try again.")}}),ee=async t=>{try{const d=(await J(t))?.data;d?.id&&(f(u=>({...u,role_id:d.id})),i(u=>({...u,role_id:[]})),localStorage.setItem("recentRoleId",String(d.id)),localStorage.setItem("recentRoleSelectedAt",Date.now().toString()))}catch(n){console.error("Failed to add role",n)}},te=t=>{if(t===0)return"0 Bytes";const n=1024,d=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(t)/Math.log(n));return parseFloat((t/Math.pow(n,u)).toFixed(2))+" "+d[u]},ae=t=>{const n=t.target.files?.[0];if(n){const d=["pdf","doc","docx"],u=n.name.split(".").pop()?.toLowerCase();if(!u||!d.includes(u)){i(A=>({...A,resume_key_path:["Only PDF, DOC, and DOCX files are allowed."]}));return}const z=5*1024*1024;if(n.size>z){i(A=>({...A,resume_key_path:["File size exceeds 5MB limit."]}));return}D(n),j({name:n.name,size:te(n.size),type:u.toUpperCase()}),i(A=>({...A,resume_key_path:[]})),T.mutate(n)}},se=()=>{j(null),f(n=>({...n,resume_key_path:""})),i(n=>({...n,resume_key_path:[]}));const t=document.getElementById("file-upload");t&&(t.value="")},le=t=>{f(n=>({...n,...t})),t.role_id&&(localStorage.setItem("recentRoleId",String(t.role_id)),localStorage.setItem("recentRoleSelectedAt",Date.now().toString())),Object.keys(t).forEach(n=>{b[n]&&i(d=>({...d,[n]:[]}))})},ne=()=>{const t=x.phone.startsWith("+91")?x.phone.replace(/^\+91/,""):`+91${x.phone.replace(/^\+91/,"")}`,n={...x,phone:t};h?X(n):Z(n)},re=()=>{p.history.back()},oe=T.isPending;return e.jsx("div",{className:"mt-4",children:e.jsx(lt,{formData:x,uploadedFile:y,errors:b,setErrors:i,isSubmitting:W||G,onChange:le,onSave:ne,handleBackNavigate:re,handleFileUpload:ae,handleDeleteFile:se,loading:oe,message:k,roleList:U,onAddRole:ee,isAdding:Y,isEdit:h,addRoleMessage:L??"",setAddRoleMessage:S,dialogOpen:E,setDialogOpen:_})})},gt=nt;export{gt as component};
