import{RouterProvider as T,createRootRoute as v,Outlet as j,HeadContent as x,Scripts as F,createFileRoute as P,lazyRouteComponent as C,createRouter as E}from"@tanstack/react-router";import{jsx as d,jsxs as h}from"react/jsx-runtime";import{isPlainObject as O,encode as $,isRedirect as H,isNotFound as M}from"@tanstack/router-core";import{startSerializer as l,mergeHeaders as R,createServerFn as N}from"@tanstack/start-client-core";import{defineHandlerCallback as A,transformReadableStreamWithRouter as D,transformPipeableStreamWithRouter as z,getHeaders as J,getEvent as k,createStartHandler as G}from"@tanstack/start-server-core";import W from"tiny-invariant";import{PassThrough as B}from"node:stream";import{isbot as y}from"isbot";import u from"react-dom/server";function _(e){return d(T,{router:e.router})}const U=A(async({request:e,router:t,responseHeaders:a})=>{if(typeof u.renderToReadableStream=="function"){const n=await u.renderToReadableStream(d(_,{router:t}),{signal:e.signal});y(e.headers.get("User-Agent"))&&await n.allReady;const o=D(t,n);return new Response(o,{status:t.state.statusCode,headers:a})}if(typeof u.renderToPipeableStream=="function"){const n=new B;try{const s=u.renderToPipeableStream(d(_,{router:t}),{...y(e.headers.get("User-Agent"))?{onAllReady(){s.pipe(n)}}:{onShellReady(){s.pipe(n)}},onError:(c,r)=>{console.error("Error in renderToPipeableStream:",c,r)}})}catch(s){console.error("Error in renderToPipeableStream:",s)}const o=z(t,n);return new Response(o,{status:t.state.statusCode,headers:a})}throw new Error("No renderToReadableStream or renderToPipeableStream found in react-dom/server. Ensure you are using a version of react-dom that supports streaming.")}),X=()=>({routes:{__root__:{filePath:"__root.tsx",children:["/"],preloads:["\\_build\\assets\\client-gqJa7_be.js","\\_build\\assets\\client-BYNfT0z-.js"]},"/":{filePath:"index.tsx"}}});function Y(e){return globalThis.MANIFEST[e]}function I(){const e=X(),t=e.routes.__root__=e.routes.__root__||{};t.assets=t.assets||[];let a="";const n=Y("client"),o=n.inputs[n.handler]?.output.path;return o||W(o,"Could not find client entry in vinxi manifest"),t.assets.push({tag:"script",attrs:{type:"module",suppressHydrationWarning:!0,async:!0},children:`${a}import("${o}")`}),e}function K(){const e=I();return{...e,routes:Object.fromEntries(Object.entries(e.routes).map(([t,a])=>{const{preloads:n,assets:o}=a;return[t,{preloads:n,assets:o}]}))}}const S=v({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"TanStack Start Starter"}]}),component:L});function L(){return d(Q,{children:d(j,{})})}function Q({children:e}){return h("html",{children:[d("head",{children:d(x,{})}),h("body",{className:"",children:[e,d(F,{})]})]})}async function V(e,t,a){var n;const o=t[0];if(O(o)&&o.method){const r=o,p=r.data instanceof FormData?"formData":"payload",f=new Headers({...p==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...r.headers instanceof Headers?Object.fromEntries(r.headers.entries()):r.headers});if(r.method==="GET"){const i=$({payload:l.stringify({data:r.data,context:r.context})});i&&(e.includes("?")?e+=`&${i}`:e+=`?${i}`)}e.includes("?")?e+="&createServerFn":e+="?createServerFn",r.response==="raw"&&(e+="&raw");const b=await a(e,{method:r.method,headers:f,signal:r.signal,...Z(r)}),m=await g(b);if((n=m.headers.get("content-type"))!=null&&n.includes("application/json")){const i=l.decode(await m.json());if(H(i)||M(i)||i instanceof Error)throw i;return i}return m}const s=await g(await a(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})),c=s.headers.get("content-type");return c&&c.includes("application/json")?l.decode(await s.json()):s.text()}function Z(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",l.stringify(e.context)),{body:e.data}):{body:l.stringify({data:e.data??null,context:e.context})}:{}}async function g(e){if(!e.ok){const t=e.headers.get("content-type");throw t&&t.includes("application/json")?l.decode(await e.json()):new Error(await e.text())}return e}function q(e){return e.replace(/^\/|\/$/g,"")}const ee=(e,t)=>{const a=`/${q(t)}/${e}`;return Object.assign((...o)=>V(a,o,async(s,c)=>{c.headers=R(J(),c.headers);const r=await $fetch.native(s,c),p=k(),f=R(r.headers,p.___ssrRpcResponseHeaders);return p.___ssrRpcResponseHeaders=f,r}),{url:a,functionId:e})},te=()=>import("./index-BIZlZw6h.js"),re=ee("app_routes_index_tsx--getCount_createServerFn_handler","/_server"),ne=N({method:"GET"}).handler(re),w=P("/")({component:C(te,"component",()=>w.ssr),loader:async()=>await ne()}),oe=w.update({id:"/",path:"/",getParentRoute:()=>S}),ae={IndexRoute:oe},se=S._addFileChildren(ae)._addFileTypes();function ie(){return E({routeTree:se,scrollRestoration:!0})}const ye=G({createRouter:ie,getRouterManifest:K})(U);export{w as R,ee as c,ye as h};
